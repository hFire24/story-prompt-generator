<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Prompt Generator</title>
    <style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #121212; /* Dark background */
        color: #e0e0e0; /* Light text */
    }

    .container {
        max-width: 600px;
        margin: auto;
        padding: 20px;
        background: #1e1e1e; /* Slightly lighter dark background */
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }

    h1 {
        text-align: center;
        color: #ffffff; /* White for title text */
    }

    label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
        color: #e0e0e0; /* Light text for labels */
    }

    textarea, input {
        width: 578px;
        margin-top: 5px;
        padding: 10px;
        border: 1px solid #444; /* Darker border */
        background-color: #1e1e1e; /* Match container background */
        color: #ffffff; /* White text */
        border-radius: 4px;
        resize: none;
        font-family: Arial, Helvetica, sans-serif;
    }

    button {
        margin-top: 20px;
        width: 100%;
        padding: 10px;
        background-color: #007BFF; /* Same blue */
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    button:hover {
        background-color: #0056b3; /* Darker blue on hover */
    }

    .output {
        margin-top: 20px;
        padding: 10px;
        background: #292929; /* Dark gray for output background */
        color: #ffffff; /* White text */
        border-radius: 4px;
        white-space: pre-wrap;
        height: 6rem;
    }
    </style>
</head>
<body>
    <div class="container">
        <h1>Story Prompt Generator</h1>

        <label for="what">Original Prompt:</label>
        <textarea id="what" rows="6" placeholder="Write a story where characters do this thing."></textarea>

        <label for="who">Main Characters:</label>
        <textarea id="who" rows="2" placeholder="Enter the characters..."></textarea>
        <button id="randomize">Randomize Character</button>

        <label for="where">Where:</label>
        <input id="where" type="text" placeholder="Where does the story take place?">
        <button id="randomizePlace">Randomize Place</button>

        <label for="date">Date:</label>
        <input id="date" type="text" placeholder="When does the story take place? (e.g., January 23, the winter)">
        <button id="selectDate">Fill in Date with month</button>

        <label for="time">Time:</label>
        <input id="time" type="text" placeholder="What time does the story take place? (e.g., 3:00 PM)">
        <button id="randomizeTime">Randomize Time</button>

        <label for="duration">Duration:</label>
        <input id="duration" type="text" placeholder="How long should the events of the story last for? (e.g., 3 hours)">

        <label for="end">Ending:</label>
        <textarea id="end" rows="3" placeholder="What happens at the end of the story?"></textarea>

        <label for="ban">Ban Coffee and Tea: </label>
        <input id="ban" type="checkbox" checked>

        <button id="generate">Generate Prompt</button>

        <textarea class="output" id="output"></textarea>
    </div>

    <script src="characters.js"></script>
    <script src="places.js"></script>
    <script>
        document.getElementById('randomize').addEventListener('click', function() {
            if (characters.length > 0) {
                const randomChoice = Math.floor(Math.random() * characters.length);
                const randomCharacter = characters[randomChoice];
                let characterList = document.getElementById('who');
                let space = "";
                if (characterList.value !== "") space = ", ";
                characterList.value += space + randomCharacter;
            } else {
                alert('No characters available to randomize.');
            }
        });

        document.getElementById('randomizePlace').addEventListener('click', function() {
            let randomChoice = Math.floor(Math.random() * 4);
            if (places.length > 0 && randomChoice === 0) {
                let randomPlace = places[Math.floor(Math.random() * places.length)];
                document.getElementById('where').value = randomPlace;
            } else {
                document.getElementById('where').value = `Character ${randomChoice}'s place`;
            }
        });

        document.getElementById('selectDate').addEventListener('click', function() {
            const d = new Date();
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const fullMonth = monthNames[d.getMonth()];
            document.getElementById('date').value = fullMonth;
        })

        document.getElementById('randomizeTime').addEventListener('click', function() {
            function getRandomTime() {
                const hour = Math.floor(Math.random() * 12) + 1; // Random hour between 1 and 12
                const minute = 0;
                const period = Math.random() < 0.5 ? 'AM' : 'PM'; // Randomly choose AM or PM
                const formattedMinute = minute < 10 ? `0${minute}` : minute; // Ensure two digits for minutes
                return `${hour}:${formattedMinute} ${period}`;
            }

            const randomTime = getRandomTime();
            document.getElementById('time').value = randomTime;
        });

        function firstLetterIsUpperCase(str) {
            if (!str || str.length === 0) return false; // Handle empty or null strings
            const firstChar = str.charAt(0); // Get the first character
            return firstChar === firstChar.toUpperCase() && firstChar !== firstChar.toLowerCase();
        }

        document.getElementById('generate').addEventListener('click', function() {
            let what = document.getElementById('what').value.trim();
            let where = document.getElementById('where').value.trim();
            let date = document.getElementById('date').value.trim();
            let time = document.getElementById('time').value.trim();
            let duration = document.getElementById('duration').value.trim();
            let ending = document.getElementById('end').value.trim();

            if (!what || !where || !date || !time || !duration) {
                alert('Please fill out all fields.');
                return;
            }

            let preposition = firstLetterIsUpperCase(date) ? 'on' : 'in';

            let prompt = `${what}.\nLocation: ${where}\nTime: ${date} at ${time} for ${duration}.\nEnding: ${ending}.`;
            prompt = prompt.replaceAll('..','.');

            if(document.getElementById("ban").checked) {
                let promptExt = "\nPlease note that ";
                let chino = prompt.includes("Chino");
                promptExt = "\nPlease note that " + (chino ? "while " : "") + "coffee and tea are banned" + (chino ? ", Chino is allowed to drink coffee." : ".");
                prompt += promptExt;
            }
            
            document.getElementById('output').textContent = prompt;
        });
    </script>
</body>
</html>
